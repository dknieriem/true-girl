!function(a,b){var c,d="ui-state-active",e="ui-state-hover",f="ui-state-disabled",g=a.ui.keyCode,h=g.UP,i=g.DOWN,j=g.RIGHT,k=g.LEFT,l=g.PAGE_UP,m=g.PAGE_DOWN,n=g.HOME,o=g.END,p=a.browser.msie,q=a.browser.mozilla?"DOMMouseScroll":"mousewheel",r=".uispinner",s=[h,i,j,k,l,m,n,o,g.BACKSPACE,g.DELETE,g.TAB];a.widget("ui.spinner",{options:{min:null,max:null,allowNull:!1,group:"",point:".",prefix:"",suffix:"",places:null,defaultStep:1,largeStep:10,mouseWheel:!0,increment:"slow",className:null,showOn:"always",width:95,upIconClass:"ui-icon-triangle-1-n",downIconClass:"ui-icon-triangle-1-s",format:function(a,b){var c=this,d=/(\d+)(\d{3})/,e=(isNaN(a)?0:Math.abs(a)).toFixed(b)+"";for(e=e.replace(".",c.point);d.test(e)&&c.group;e=e.replace(d,"$1"+c.group+"$2"));return(a<0?"-":"")+c.prefix+e+c.suffix},parse:function(a){var b=this;return"."==b.group&&(a=a.replace(".","")),"."!=b.point&&(a=a.replace(b.point,".")),parseFloat(a.replace(/[^0-9\-\.]/g,""))}},_create:function(){var a=this,b=a.element,c=b.attr("type");!b.is("input")||"text"!=c&&"number"!=c||(a._procOptions(!0),a._createButtons(b),b.is(":enabled")||a.disable())},_createButtons:function(b){function f(){return E&&(a(this).removeClass(d),F._stopSpin(),E=!1),!1}function q(){if(!G.disabled){var b=F.element[0],c=this===w?1:-1;b.focus(),b.select(),a(this).addClass(d),E=!0,F._startSpin(c)}return!1}function t(a){function b(){z=0,a()}if(z){if(a===A)return;clearTimeout(z)}A=a,z=setTimeout(b,100)}function u(a,b){if(D)return!1;var c=String.fromCharCode(b||a),d=F.options;return!(c>="0"&&c<="9"||"-"==c)&&!(F.places>0&&c==d.point||c==d.group)}function v(a){for(var b=0;b<s.length;b++)if(s[b]==a)return!0;return!1}var w,x,y,z,A,B,C,D,E,F=this,G=F.options,H=G.className,I=G.width,J=G.showOn,K=a.support.boxModel,L=b.outerHeight(),M=(F.oMargin=function(a){return"auto"==a?0:parseInt(a)}(b.css("margin-right")),F.wrapper=b.wrap('<span class="spinner-wrpr" />').css({width:(F.oWidth=K?b.width():b.outerWidth())-I,marginRight:"30px",marginLeft:"30px",textAlign:"center",float:"none",marginTop:0}).after('<span class="ui-spinner ui-widget"></span>').next()),N=F.btnContainer=a('<div class="ui-spinner-buttons"><div class="ui-spinner-up ui-spinner-button ui-state-default ui-corner-tr"><span class="ui-icon '+G.upIconClass+'"> </span></div><div class="ui-spinner-down ui-spinner-button ui-state-default ui-corner-br"><span class="ui-icon '+G.downIconClass+'"> </span></div></div>'),O="rtl"==b[0].dir;H&&M.addClass(H),M.append(N.css({height:L,left:0,top:0})),y=F.buttons=N.find(".ui-spinner-button"),y.css({width:"30px",height:L-(K?y.outerHeight()-y.height():0)}),y.eq(0).css({right:"0"}),y.eq(1).css({left:"0"}),w=y[0],x=y[1],y.find(".ui-icon"),N.width("105px"),"always"!=J&&N.css("opacity",0),"hover"!=J&&"both"!=J||y.add(b).bind("mouseenter"+r,function(){t(function(){B=!0,F.focused&&"hover"!=J||F.showButtons()})}).bind("mouseleave"+r,function(){t(function(){B=!1,F.focused&&"hover"!=J||F.hideButtons()})}),y.hover(function(){F.buttons.removeClass(e),G.disabled||a(this).addClass(e)},function(){a(this).removeClass(e)}).mousedown(q).mouseup(f).mouseout(f),p&&y.dblclick(function(){return G.disabled||(F._change(),F._doSpin((this===w?1:-1)*G.step)),!1}).bind("selectstart",function(){return!1}),b.bind("keydown"+r,function(b){var c,e,f,g=b.keyCode;if(b.ctrl||b.alt)return!0;if(v(g)&&(D=!0),C)return!1;switch(g){case h:case l:c=1,e=g==l;break;case i:case m:c=-1,e=g==m;break;case j:case k:c=g==j^O?1:-1;break;case n:return f=F.options.min,null!=f&&F._setValue(f),!1;case o:return f=F.options.max,f=F.options.max,null!=f&&F._setValue(f),!1}return c?(C||G.disabled||(keyDir=c,a(c>0?w:x).addClass(d),C=!0,F._startSpin(c,e)),!1):void 0}).bind("keyup"+r,function(a){if(a.ctrl||a.alt)return!0;switch(v(g)&&(D=!1),a.keyCode){case h:case j:case l:case i:case k:case m:return y.removeClass(d),F._stopSpin(),C=!1,!1}}).bind("keypress"+r,function(a){if(u(a.keyCode,a.charCode))return!1}).bind("change"+r,function(){F._change()}).bind("focus"+r,function(){function a(){F.element.select()}p?a():setTimeout(a,0),F.focused=!0,c=F,B||"focus"!=J&&"both"!=J||F.showButtons()}).bind("blur"+r,function(){F.focused=!1,B||"focus"!=J&&"both"!=J||F.hideButtons()})},_procOptions:function(a){var b,c=this,d=c.element,e=c.options,f=e.min,g=e.max,h=e.step,i=e.places,j=-1;"slow"==e.increment?e.increment=[{count:1,mult:1,delay:250},{count:3,mult:1,delay:100},{count:0,mult:1,delay:50}]:"fast"==e.increment&&(e.increment=[{count:1,mult:1,delay:250},{count:19,mult:1,delay:100},{count:80,mult:1,delay:20},{count:100,mult:10,delay:20},{count:0,mult:100,delay:20}]),null==f&&null!=(b=d.attr("min"))&&(f=parseFloat(b)),null==g&&null!=(b=d.attr("max"))&&(g=parseFloat(b)),h||null==(b=d.attr("step"))||"any"!=b&&(h=parseFloat(b),e.largeStep*=h),e.step=h=h||e.defaultStep,null==i&&-1!=(b=h+"").indexOf(".")&&(i=b.length-b.indexOf(".")-1),c.places=i,null!=g&&null!=f&&(f>g&&(f=g),j=Math.max(Math.max(j,e.format(g,i,d).length),e.format(f,i,d).length)),a&&(c.inputMaxLength=d[0].maxLength),b=c.inputMaxLength,b>0&&(j=j>0?Math.min(b,j):b,b=Math.pow(10,j)-1,(null==g||g>b)&&(g=b),b=-(b+1)/10+1,(null==f||f<b)&&(f=b)),j>0&&d.attr("maxlength",j),e.min=f,e.max=g,c._change(),d.unbind(q+r),e.mouseWheel&&d.bind(q+r,c._mouseWheel)},_mouseWheel:function(b){var d=a.data(this,"spinner");if(!d.options.disabled&&d.focused&&c===d)return d._change(),d._doSpin(((b.wheelDelta||-b.detail)>0?1:-1)*d.options.step),!1},_setTimer:function(a,b,c){function d(){e._spin(b,c)}var e=this;e._stopSpin(),e.timer=setInterval(d,a)},_stopSpin:function(){this.timer&&(clearInterval(this.timer),this.timer=0)},_startSpin:function(a,b){var c=this,d=c.options,e=d.increment;c._change(),c._doSpin(a*(b?c.options.largeStep:c.options.step)),e&&e.length>0&&(c.counter=0,c.incCounter=0,c._setTimer(e[0].delay,a,b))},_spin:function(a,b){var c=this,d=c.options.increment,e=d[c.incCounter];c._doSpin(a*e.mult*(b?c.options.largeStep:c.options.step)),++c.counter>e.count&&c.incCounter<d.length-1&&(c.counter=0,e=d[++c.incCounter],c._setTimer(e.delay,a,b))},_doSpin:function(a){var b=this,c=b.curvalue;null==c&&(c=(a>0?b.options.min:b.options.max)||0),b._setValue(c+a)},_parseValue:function(){var a=this.element.val();return a?this.options.parse(a,this.element):null},_validate:function(a){var b=this.options,c=b.min,d=b.max;return null!=a||b.allowNull||(a=null!=this.curvalue?this.curvalue:c||d||0),null!=d&&a>d?d:null!=c&&a<c?c:a},_change:function(){var a=this,b=a._parseValue();a.options.min,a.options.max;a.selfChange||(isNaN(b)&&(b=a.curvalue),a._setValue(b,!0))},_setOption:function(b,c){a.Widget.prototype._setOption.call(this,b,c),this._procOptions()},increment:function(){this._doSpin(this.options.step)},decrement:function(){this._doSpin(-this.options.step)},showButtons:function(a){var b=this.btnContainer.stop();a?b.css("opacity",1):b.fadeTo("fast",1)},hideButtons:function(a){var b=this.btnContainer.stop();a?b.css("opacity",0):b.fadeTo("fast",0),this.buttons.removeClass(e)},_setValue:function(a,b){var c=this;c.curvalue=a=c._validate(a),c.element.val(null!=a?c.options.format(a,c.places,c.element):""),b||(c.selfChange=!0,c.element.change(),c.selfChange=!1)},value:function(a){return arguments.length?(this._setValue(a),this.element):this.curvalue},enable:function(){this.buttons.removeClass(f),this.element[0].disabled=!1,a.Widget.prototype.enable.call(this)},disable:function(){this.buttons.addClass(f).removeClass(e),this.element[0].disabled=!0,a.Widget.prototype.disable.call(this)},destroy:function(b){this.wrapper.remove(),this.element.unbind(r).css({width:this.oWidth,marginRight:this.oMargin}),a.Widget.prototype.destroy.call(this)}})}(jQuery);