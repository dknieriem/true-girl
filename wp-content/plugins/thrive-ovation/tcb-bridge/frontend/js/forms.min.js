/*! Thrive Ovation - 2017-02-15
* http://www.thrivethemes.com/
* Copyright (c) 2017 Thrive Themes */
!function(a){a.fn.testimonial_capture_form=function(){return this.each(function(){var b=a(this),c=b.find(".on_success").val();b.wrapInner('<form method="post"></form>'),b.find(".tvo-form-picture").hover(function(){var b=a(this);b.attr("src")==b.attr("data-default")&&b.find(".tvo-social-picture").show()},function(){a(this).find(".tvo-social-picture").hide()}),b.find(".tvo_email").blur(function(){var c=this.value,d=b.find(".tvo-picture-wrapper");if(d.length>0){var e=d.data("default"),g=d.css("background-image").replace(/^url\(["']?/,"").replace(/["']?\)$/,"");f(c)&&g==e&&a.ajax({type:"GET",url:TVO_Form.gravatar_route,data:{email:c}}).done(function(a){a&&(d.css("background-image","url("+a+")"),b.find(".tvo-remove-image").show())})}}),b.find(".tvo-remove-image").click(function(){var c=b.find(".tvo-picture-wrapper");c.css("background-image","url("+c.attr("data-default")+")"),a(this).hide()});var d=function(){var c=!1;return b.find(".tvo_input").each(function(){var b=a(this);b.hasClass("tvo_required")&&0===b.val().length?(b.addClass("tvo_required_error"),c=!0):b.removeClass("tvo_required_error")}),c},e=function(a){var c=b.find(".tvo-form-error");c.html(a)},f=function(){var a=/\S+@\S+\.\S+/,c=b.find(".tvo_email");return""===c.val()?!0:a.test(c.val())},g=function(){var a=b.find(".tvo_website_url").val(),c=new RegExp("^(?!mailto:)(?:(?:http|https|ftp)://)(?:\\S+(?::\\S*)?@)?(?:(?:(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[0-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]+-?)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]+-?)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,})))|localhost)(?::\\d{2,5})?(?:(/|\\?|#)[^\\s]*)?$");return"undefined"!=typeof a&&""!=a?c.test(a):!0},h=function(){var c={},d=b.find(".tvo-picture-wrapper");return b.find(".tvo_input").each(function(){var b=a(this),d=b.attr("name"),e=b.val();"undefined"!=typeof d&&(c[d]=e)}),c.content="",b.find(".tvo-form-textarea").each(function(){c.content+=" <p>"+this.value+"</p> "}),b.find(".g-recaptcha").length?(c._use_captcha=1,c["g-recaptcha-response"]=b.find(".g-recaptcha-response").val()):c._use_captcha=0,d.length>0?(c.picture_url=d.css("background-image").replace(/^url\(["']?/,"").replace(/["']?\)$/,""),d.attr("data-default")==c.picture_url&&(c.picture_url="")):c.picture_url="",c},i=function(){var a=b.find(".tvo-form-config"),c={};return c.tags=JSON.parse(a.find(".tags").val()),c.shortcode_id=a.find(".shortcode_id").val(),c};b.on("submit",function(j){if(j.stopPropagation(),j.preventDefault(),b.find(".tvo-form-button").text(TVO_Form.translate.sending),e(""),d())return b.find(".tvo-form-button").text(TVO_Form.translate.submit),e(TVO_Form.translate.required),!1;if(!f())return b.find(".tvo-form-button").text(TVO_Form.translate.submit),e(TVO_Form.translate.validEmail),!1;if(!g())return b.find(".tvo-form-button").text(TVO_Form.translate.submit),e(TVO_Form.translate.validURL),!1;var k=h(),l=b.find(".tvo_form_state"),m=b.find(".tvo_success_state"),n=i();a.extend(k,n),b.find(".tvo-form-button").attr("disabled",!0),a.ajax({type:"POST",url:TVO_Form.testimonial_route,data:k}).fail(function(a){b.find(".tvo-form-button").text(TVO_Form.translate.submit),b.find(".tvo-form-button").attr("disabled",!1),e(a.responseJSON.message)}).done(function(){switch(c){case"message":l.hide(),m.show();break;case"redirect":window.location=b.find(".on_redirect").val()}})})})},a(function(){a(".tvo_testimonial_form").testimonial_capture_form()})}(jQuery);